'Set up sub, just working within one worksheet to begin
Sub stock_analysis()
    
    'Set up initial variables
    Dim stock_name As String
    
    Dim yearly_change As Double
    yearly_change = 0
    
    Dim percent_change As Double
    percent_change = 0
    
    Dim total_volume As Double
    total_volume = 0
    
    Dim summary_row As Integer
    summary_row = 2
    
    Dim last_row As Long
    last_row = Cells(Rows.Count, 1).End(xlUp).Row
    
    Dim opening_price As Double
    opening_price = 0
     
    Dim trading_day_count As Integer
    trading_day_count = 0
    
    Dim closing_price As Double
    closing_price = 0
    'MsgBox (last_row)
    
    'begin for loop testing up to row 788
    For i = 2 To 788
        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then
            
            'change stock name
            stock_name = Cells(i, 1).Value
            
            'add to count of the stock volume
            total_volume = total_volume + Cells(i, 7).Value
            
            'print ticker name in summary table
            Range("I" & summary_row).Value = stock_name
            
            'print total stock volume in summary table
            Range("L" & summary_row).Value = total_volume

            'pull opening value from beginning of year
            opening_value = Cells(i - trading_day_count, 3).Value
            'MsgBox (opening_price)
            
            'pull closing value from end of year
            closing_value = Cells(i, 6).Value
            'MsgBox (closing_value)
            
            'print yearly change in summary table
            Range("J" & summary_row).Value = closing_value - opening_value
            
            If closing_value - opening_value < 0 Then
                Range("J" & summary_row).Interior.ColorIndex = 3
                
            ElseIf closing_value - opening_value > 0 Then
                Range("J" & summary_row).Interior.ColorIndex = 4
                
            End If
            'print percent change in summary table
            Range("K" & summary_row).Value = ((closing_value - opening_value) / opening_value)
            
            'increment summary row
            summary_row = summary_row + 1
            
            'reset total stock volume
            total_volume = 0
            
            'reset trading day count
            trading_day_count = 0
            
            
           Else
           
            'increment trading day count
            trading_day_count = trading_day_count + 1
            
            'continue totaling stock volume
            total_volume = total_volume + Cells(i, 7).Value
        End If
            
    Next i

End Sub
